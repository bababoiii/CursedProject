# Системное Определение Контрпиков

Это проект, направленный на создание моделей для предсказания исходов матчей и рекомендаций по подбору героев в Dota 2. В проекте используются различные архитектуры нейросетей на базе TensorFlow/Keras для решения двух задач:

1. **Предсказание исхода матча.**  
   Модель обучается на данных об игроках и выбранных героях, чтобы предсказать, какая команда (Radiant или Dire) одержит победу. В процессе экспериментов использовались как простые подходы (например, векторизация команд с +1 и –1 для героев разных сторон), так и более сложные модели с эмбеддингами и мультитаск-обучением с использованием постматчевой статистики.

2. **Hero Picker.**  
   Модель, обученная на матчах, способна по составу проигравшей команды предлагать оптимальный выбор героев для победы. Это особенно полезно для подбора контрпиков (counter-pick). Кроме того, функция позволяет интерактивно задать команду – либо сгенерировать случайный набор героев соперника, либо ввести его вручную (при этом поддерживается ввод имён героев, которые автоматически переводятся в их идентификаторы).

## Возможности проекта

- **Предсказание исходов матчей.**  
  Разработка и обучение моделей для определения победителя на основе состава команд.
  
- **Генерация рекомендаций по героям.**  
  Обучение модели, которая по составу соперников возвращает рекомендации для подбора героев, способствующих победе.
  
- **Интеграция вспомогательных признаков.**  
  Использование матрицы синергии героев и постматчевой статистики для улучшения качества обучения и более точного определения эффективности героев.
  
- **Интерактивный режим.**  
  Возможность как автоматической генерации случайного состава противника, так и ручного ввода с поддержкой имён героев.

## Структура проекта

Проект состоит из следующих файлов и данных:

- **`README.md`** — Информация о проекте, запуске, установке, структуре.
- **`parser.py`** — Скрипт для сбора и парсинга данных матчей. Скачивает и сохраняет данные из открытых источников.
- **`ML_project.ipynb`** — Код, в которой реализовано машинное обучение:
  - построение и обучение моделей предсказания победы;
  - hero picker — генерация лучших героев против заданного состава;
  - вспомогательные функции.
- **`heroes.zip`** — архив, содержащий `heroes.json` — список всех героев и их идентификаторов.
- **`parsed_matches.zip`** — архив, содержащий `parsed_matches.json` — подготовленные матчи (идентификаторы героев, победитель и т.п.).

## Требования

- Python **3.7+**
- Установленные библиотеки:

### Для `parser.py`
```bash
pip install requests beautifulsoup4
```

Импорты:
```python
import time
import random as rnd
import requests
from bs4 import BeautifulSoup
import json
import os
```

### Для `ML_project.ipynb`
```bash
pip install pandas numpy tensorflow matplotlib scikit-learn scipy
```

Импорты:
```python
import pandas as pd
import numpy as np
import tensorflow as tf
import random as rnd
import itertools
from tensorflow import keras
from tensorflow.keras import Model, Input, Sequential, models, layers, optimizers, regularizers, callbacks
from tensorflow.keras.callbacks import EarlyStopping
from sklearn.model_selection import train_test_split
from sklearn.utils.class_weight import compute_class_weight
import scipy as scp
import matplotlib.pyplot as plt
import zipfile
import json
%matplotlib inline
```

## Установка и запуск

1. **Клонируйте репозиторий или скачайте проект.**

2. **Убедитесь, что у вас есть архивы:**
   - `heroes.zip`, содержащий файл `heroes.json`
   - `parsed_matches.zip`, содержащий файл `parsed_matches.json`

   Эти файлы необходимы для запуска машинного обучения. Их можно распаковать вручную или программно.

3. **Для запуска парсера:**
   Просто запустите файл:
   ```bash
   python parser.py
   ```

4. **Для запуска моделей:**
   Откройте `ML_project.ipynb` в Jupyter Notebook или Colab.

   Убедитесь, что в рабочей директории присутствуют `heroes.zip` и `parsed_matches.zip`.

   Далее следуйте ячейкам в ноутбуке, начиная с импорта библиотек и загрузки данных.

---

Проект будет полезен для интересующихся машинным обучением в гейминге, предсказанием матчей и подбором контрпиков в Dota 2.


